import{d as h,a as f}from"./constants-Cszep78z.js";async function p(){const s=JSON.parse(localStorage.getItem("userName"));if(!s){alert("User not logged in. Redirecting to login..."),window.location.href="/src/html/login.html";return}try{const n=localStorage.getItem("accessToken");if(!n){alert("User is not logged in. Redirecting to login..."),window.location.href="/src/html/login.html";return}const t=await fetch(`${h}/${s}?_listings=true&_bids=true`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`,"X-Noroff-API-Key":f}});if(console.log("Fetching user listings..."),t.ok){const o=await t.json();console.log("User profile data:",o);const e=o.data.listings||[];b(e)}else{const o=await t.json();console.error("Error fetching user listings:",o),alert(`Failed to fetch listings: ${o.errors?.[0]?.message||"Unknown error"}`)}}catch(n){console.error("Error fetching user listings:",n),alert("An unexpected error occurred.")}}function b(s){const n=document.getElementById("listings-container");if(n.textContent="",s.length===0){n.textContent="No listings found.";return}s.forEach(t=>{console.log("Processing listing:",t);const o=document.createElement("div");o.classList.add("relative","overflow-hidden","rounded-lg","group","shadow-md","transition-colors","duration-300","hover:shadow-lg");const e=document.createElement("a");e.href=`/src/html/productpage.html?listingId=${t.id}`,e.classList.add("block","h-full","w-full");const i=document.createElement("div");i.classList.add("h-64","w-full","relative","bg-cover","bg-center","transition-colors","duration-300"),t.media&&Array.isArray(t.media)&&t.media.length>0?i.style.backgroundImage=`url(${t.media[0].url})`:i.style.backgroundImage="url('https://images.unsplash.com/photo-1521193089946-7aa29d1fe776?q=80&w=2340&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D')";const u=document.createElement("div");u.classList.add("absolute","inset-0","bg-customDYellow","opacity-0","transition-opacity","duration-300");const a=document.createElement("h1");a.textContent=t.title||"Untitled",a.setAttribute("title",t.title||"Untitled"),a.classList.add("absolute","bottom-0","left-0","w-full","bg-customDYellow","text-black","text-sm","font-bold","pt-8","py-2","px-4","rounded-t-lg","block","h-24","truncate");const r=document.createElement("div"),g=new Date(t.endsAt)-new Date,l=Math.ceil(g/(1e3*60*60*24));r.textContent=l>1?`${l} days left`:l===1?"1 day left":"Ended",r.classList.add("absolute","top-2","right-2","bg-customBlue","text-white","text-xs","font-baloo","py-1","px-2","rounded");const d=t.bids&&t.bids.length>0?Math.max(...t.bids.map(m=>m.amount)):0;console.log("Highest bid for listing:",t.id,d);const c=document.createElement("h2");c.textContent=d>0?`Highest Bid: $${d}`:"No bids yet",c.classList.add("absolute","bottom-2","px-4","md:text-sm","block"),e.appendChild(i),e.appendChild(u),e.appendChild(a),e.appendChild(c),e.appendChild(r),o.appendChild(e),n.appendChild(o)})}p();
