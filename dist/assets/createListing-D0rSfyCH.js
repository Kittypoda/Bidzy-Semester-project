import{A as d,a as g}from"./constants-Cszep78z.js";const m=document.getElementById("create-listing-btn"),i=document.getElementById("create-listing-popup"),u=document.getElementById("cancel-create-listing-btn"),h=document.getElementById("create-listing-form");m.addEventListener("click",()=>{i.classList.remove("hidden")});u.addEventListener("click",()=>{i.classList.add("hidden")});h.addEventListener("submit",async c=>{c.preventDefault();const r=document.getElementById("listing-title").value.trim(),a=document.getElementById("listing-description").value.trim(),o=document.getElementById("listing-media").value.trim(),s=document.getElementById("listing-end-time").value;if(!r||!s){alert("Title and End Time are required.");return}const l={title:r,description:a||null,media:o?[{url:o,alt:"Listing media"}]:null,endsAt:new Date(s).toISOString()};try{const e=localStorage.getItem("accessToken");if(!e){alert("User is not logged in. Redirecting to login..."),window.location.href="/src/html/login.html";return}const n=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`,"X-Noroff-API-Key":g},body:JSON.stringify(l)});if(n.ok){const t=await n.json();console.log("Created Listing:",t),i.classList.add("hidden"),window.location.href="/src/html/mylistings.html"}else{const t=await n.json();console.error("Error creating listing:",t),alert(`Failed to create listing: ${t.errors?.[0]?.message||"Unknown error"}`)}}catch(e){console.error("Error submitting listing:",e),alert("An unexpected error occurred while creating the listing.")}});
